<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gts.base.platform.comment">
	
	<resultMap id="commentMap" type="com.gts.base.platform.dao.entity.Comment" >
		<id property="commentId" column="COMMENT_ID" jdbcType="INTEGER" />
		<result property="studentId" column="STUDENT_ID" jdbcType="INTEGER" />
		<result property="comment" column="COMMENT" jdbcType="VARCHAR" />
		<result property="commentPerson" column="COMMENT_PERSON" jdbcType="VARCHAR" />
		<result property="gradeStage" column="GRADE_STAGE" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE " jdbcType="TIMESTAMP" />
		<result property="gmtModify" column="GMT_MODIFY" jdbcType="TIMESTAMP" />
		<result property="startCreateDate" column="startCreateDate" jdbcType="TIMESTAMP" />
		<result property="endCreateDate" column="endCreateDate" jdbcType="TIMESTAMP" />
	</resultMap>
	
	<sql id="comment_column">
		STUDENT_ID,COMMENT,COMMENT_PERSON,GRADE_STAGE,GMT_CREATE,GMT_MODIFY
	</sql>
	
	<sql id="where_condition">
		<if test="commentId != null">
			AND COMMENT_ID=#{commentId,jdbcType=INTEGER} 
		</if>
		<if test="studentId != null">
			AND STUDENT_ID=#{studentId,jdbcType=INTEGER} 
		</if>
		<if test="comment != null">
			AND COMMENT=#{comment,jdbcType=VARCHAR} 
		</if>
		<if test="commentPerson != null">
			AND COMMENT_PERSON=#{commentPerson,jdbcType=VARCHAR} 
		</if>
		<if test="gradeStage != null">
			AND GRADE_STAGE=#{gradeStage,jdbcType=VARCHAR} 
		</if>
		<if test="startCreateDate != null">
			AND GMT_CREATE &gt; #{startCreateDate,jdbcType=TIMESTAMP} 
		</if>
		<if test="endCreateDate != null">
			AND GMT_CREATE &lt; #{endCreateDate,jdbcType=TIMESTAMP} 
		</if>
	</sql>
	
	<insert id="insertComment" parameterType="com.gts.base.platform.dao.entity.Comment" keyProperty="commentId" useGeneratedKeys="true">
		INSERT INTO GTS_COMMENT (<include refid="comment_column" />) VALUES 
		<![CDATA[
		(#{studentId,jdbcType=INTEGER},#{comment,jdbcType=VARCHAR},#{commentPerson,jdbcType=VARCHAR},#{gradeStage,jdbcType=VARCHAR},now(),now())
		]]>
	</insert>
	
	<update id="updateComment" parameterType="com.gts.base.platform.dao.entity.Comment">
		UPDATE GTS_COMMENT SET GMT_MODIFY=now() 
		<if test="studentId != null">
			,STUDENT_ID=#{studentId,jdbcType=INTEGER} 
		</if>
		<if test="comment != null">
			,COMMENT=#{comment,jdbcType=VARCHAR} 
		</if>
		<if test="commentPerson != null">
			,COMMENT_PERSON=#{commentPerson,jdbcType=VARCHAR} 
		</if>
		<if test="gradeStage != null">
			,GRADE_STAGE=#{gradeStage,jdbcType=VARCHAR} 
		</if>
		WHERE COMMENT_ID = #{commentId}
	</update>
	
	<select id="queryComment" resultMap="commentMap" parameterType="com.gts.base.platform.dao.entity.Comment">
		SELECT COMMENT_ID,<include refid="comment_column" /> FROM GTS_COMMENT 
		<where>
			<include refid="where_condition" />
		</where>
		ORDER BY GMT_CREATE DESC
	</select>
	
	<select id="listPageComment" resultMap="commentMap" parameterType="com.gts.base.platform.dao.entity.Comment" flushCache="true" >
		SELECT COMMENT_ID,<include refid="comment_column" /> FROM GTS_COMMENT 
		<where>
			<include refid="where_condition" />
		</where>
		ORDER BY GMT_CREATE DESC
	</select>
	
	<select id="getComment" resultMap="commentMap" parameterType="com.gts.base.platform.dao.entity.Comment" >
		SELECT COMMENT_ID,<include refid="comment_column" /> FROM GTS_COMMENT WHERE COMMENT_ID = #{commentId}
	</select>
	
</mapper>
