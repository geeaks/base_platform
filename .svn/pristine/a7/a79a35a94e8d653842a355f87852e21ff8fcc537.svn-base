package com.ucf.customer.dao.impl;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import org.springframework.stereotype.Repository;

import com.ucf.customer.dao.UcfDistrictDao;
import com.ucf.customer.dao.base.BaseCustomerDao;
import com.ucf.customer.pojo.UcfDistrict;

/**
 * 省市级联#区县DAO实现
 * Description: 
 * All Rights Reserved.
 * @version 1.0  2014-3-14 下午1:39:19  by WangYanCheng（wangyancheng@ucfgroup.com）创建
 */
@Repository
public class UcfDistrictDaoImpl extends BaseCustomerDao implements UcfDistrictDao {

	/**
	 * serial number
	 */
	private static final long serialVersionUID = 1L;

	@Override
	public void insertUcfDistrict(UcfDistrict ucfDistrict) throws Exception {
		this.insert("com.ucf.customer.insertUcfDistrict", ucfDistrict);
	}

	@Override
	public void updateUcfDistrict(UcfDistrict ucfDistrict) throws Exception {
		this.update("com.ucf.customer.updateUcfDistrict", ucfDistrict);
	}

	@Override
	public void deleteUcfDistrict(String id) throws Exception {
		this.delete("com.ucf.customer.deleteUcfDistrict", id);
	}

	@Override
	public List<UcfDistrict> queryUcfDistrictByWhere(UcfDistrict district) throws Exception {
		return this.queryForList("com.ucf.customer.queryUcfDistrictByWhere", district);
	}

	@Override
	public List<String> queryAllProvinceData() {
		List<String> rtnList = new ArrayList<String>();
		List<Map<String, String>> tmpArray = this.queryForList("com.ucf.customer.queryAllProvinceData");
		innerQuery(tmpArray, rtnList);
		return rtnList;
	}


	@Override
	public List<String> queryAllCityData() {
		List<String> rtnList = new ArrayList<String>();
		List<Map<String, String>> tmpArray = this.queryForList("com.ucf.customer.queryAllCityData");
		innerQuery(tmpArray, rtnList);
		return rtnList;
	}

	@Override
	public List<String> queryAllDistrictData() {
		List<String> rtnList = new ArrayList<String>();
		List<Map<String, String>> tmpArray = this.queryForList("com.ucf.customer.queryAllDistrictData");
		innerQuery(tmpArray, rtnList);
		return rtnList;
	}
	/**
	 * 封装数据转换
	 */
	private void innerQuery(List<Map<String, String>> tmpArray, List<String> rtnList) {
		for (Map<String, String> obj : tmpArray) {
			rtnList.add(obj.get("CODE"));
			rtnList.add(obj.get("NAME"));
		}		
	}
}
